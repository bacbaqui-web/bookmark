<!DOCTYPE html>
<html lang="ko">
<head>
 <script>
  window.__app_id = 'img-bookmarks-prod';
  window.__firebase_config = {
    apiKey: "AIzaSyDk3LHORKBfYH6AX7z9HDtMKlWnjTmJ0", 
    authDomain: "baquibookmark.firebaseapp.com",
    projectId: "baquibookmark",
    storageBucket: "baquibookmark.appspot.com",
    messagingSenderId: "1078119895273",
    appId: "1:1078119895273:web:f6397b77babfd705a52078",
    measurementId: "G-F3F20T6M6C"
  };
  window.__initial_auth_token = null;
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>이미지 북마크</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body {
      font-family: 'Inter', sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
  }
  .drag-area {
      border: 2px dashed #4b4b4b;
      transition: all 0.3s ease;
  }
  .drag-area.active {
      border-color: #6b6b6b;
      background-color: #2a2a2a;
  }
  .image-card {
      position: relative;
      transition: transform 0.2s ease-in-out;
  }
  .image-card:hover {
      transform: translateY(-5px);
  }
</style>
</head>
<body class="bg-[#1a1a1a] min-h-screen flex items-center justify-center p-4">

<!-- 상단 로그인 바 -->
<div class="fixed top-3 left-1/2 -translate-x-1/2 z-50 w-[min(1100px,95vw)]">
  <div class="flex items-center justify-between rounded-xl px-4 py-2 bg-[#2a2a2a]/80 backdrop-blur border border-[#3c3c3c]">
    <div class="text-sm text-[#ababab]">
      <span id="auth-state">로그아웃됨</span>
    </div>
    <div class="flex gap-2">
      <button id="btn-google" class="px-3 py-1.5 rounded-md bg-white text-gray-900 text-sm font-medium hover:bg-gray-100">Google 로그인</button>
      <button id="btn-anon" class="px-3 py-1.5 rounded-md bg-[#424242] text-white text-sm font-medium hover:bg-[#525252]">익명 로그인</button>
      <button id="btn-logout" class="px-3 py-1.5 rounded-md bg-[#424242] text-white text-sm font-medium hover:bg-[#525252] hidden">로그아웃</button>
    </div>
  </div>
</div>

<!-- 로딩 오버레이 -->
<div id="loading-overlay" class="fixed inset-0 bg-[#1a1a1a] bg-opacity-70 z-40 flex items-center justify-center hidden">
  <div class="flex flex-col items-center">
    <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-white"></div>
    <p class="text-white mt-4 text-lg">데이터를 불러오는 중...</p>
  </div>
</div>

<!-- 본문 카드 -->
<main class="bg-[#242424] rounded-xl p-6 w-full max-w-4xl mx-auto flex flex-col space-y-6 mt-12">
  <header class="text-center">
    <h1 class="text-white text-2xl font-semibold">이미지 북마크</h1>
    <p class="text-[#b3b3b3] text-sm mt-1">이미지를 드래그&드롭하거나 이미지 URL을 끌어다 놓으세요.</p>
  </header>

  <section id="drag-area" class="drag-area rounded-lg p-8 flex items-center justify-center text-center text-[#999999] font-medium cursor-pointer">
    <div>
      <p class="text-base">여기로 <span class="text-white font-semibold">이미지</span>를 드래그하세요</p>
      <p class="text-xs mt-1 text-[#666666]">파일 업로드는 지원하지 않습니다. 웹의 이미지 또는 이미지 URL만 저장됩니다.</p>
    </div>
  </section>

  <section id="image-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-2"></section>

  <!-- 경고 모달 -->
  <div id="alert-modal" class="fixed inset-0 bg-[#1a1a1a] bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-[#242424] rounded-lg p-6 shadow-xl max-w-sm mx-auto">
      <p id="modal-message" class="text-white text-lg text-center font-medium"></p>
      <div class="mt-4 flex justify-center">
        <button id="modal-close-btn" class="px-4 py-2 bg-[#424242] text-white rounded-md hover:bg-[#525252] focus:outline-none">확인</button>
      </div>
    </div>
  </div>
</main>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import {
      getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged,
      GoogleAuthProvider, signInWithPopup, signOut
  } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
  import {
      getFirestore, collection, onSnapshot, addDoc, deleteDoc, doc,
      query, orderBy, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
  const firebaseConfig =
    typeof __firebase_config !== 'undefined' ? __firebase_config : {};
  const initialAuthToken =
    typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

  let db, auth, userId, unsubscribeImages = null;

  // (여기서부터는 이전 코드 동일: initFirebase(), setupRealtimeListener() 등등)
  // ...
</script>
</body>
</html>
